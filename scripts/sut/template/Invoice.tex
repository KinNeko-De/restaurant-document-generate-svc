%% LyX 2.3.7 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass{scrartcl}
\usepackage[T1]{fontenc}
\usepackage{array}
\usepackage{polyglossia}
\usepackage{luacode}
\usepackage{tabularx}
\usepackage{colortbl}
\usepackage{xcolor}
\setdefaultlanguage{german}

\definecolor{gray!10}{gray}{0.9}
\definecolor{gray!20}{gray}{0.8}
\definecolor{gray!30}{gray}{0.7}
\definecolor{gray!40}{gray}{0.6}
\definecolor{gray!50}{gray}{0.5}
\definecolor{gray!60}{gray}{0.4}
\definecolor{gray}{gray}{0.0}

%% includes the model of the invoice
%% file is filled with test data
%% on every request a specific model for the request will be generated
%% do not try to load model.lua because somewhere is another model.lua that will be loaded
\directlua{ model = require("./data.lua")}

\setlength{\parindent}{0pt}

\begin{document}
\begin{minipage}[t]{0.65\columnwidth}%
\begin{flushleft}
\huge \textbf{restaurant.think.different}
\par\end{flushleft}%
\end{minipage} \hfill{}%
\begin{minipage}[t]{0.3\columnwidth}%
\begin{flushright}
\huge \textbf{Rechnung}
\par\end{flushright}%
\end{minipage}

\bigskip{}

\begin{minipage}[t]{0.3\columnwidth}
\directlua{tex.sprint(model.invoice.recipient.name, "\\\\")}
\directlua{tex.sprint(model.invoice.recipient.street, "\\\\")}
\directlua{tex.sprint(model.invoice.recipient.city, ", ", model.invoice.recipient.postCode, "\\\\")}
\directlua{tex.sprint(model.invoice.recipient.country, "\\\\")}
\end{minipage}
\hfill{}%
\begin{minipage}[t]{0.6\columnwidth}%
{Referenznummer XXX} \\
{Verkauf durch Verkäufer} \\
{\rule[0.5ex]{1\columnwidth}{1pt}} \\
{Rechnungsdatum /} \\
{Lieferdatum \luaexec{tex.sprint(os.date("\%d.\%m.\%Y", model.invoice.deliveredOn.seconds))}} \\
\end{minipage}

\vspace{10ex}

\small

\begin{luacode}
  tex.sprint("\\begin{tabularx}{\\textwidth}{>{\\columncolor{gray!10}}X>{\\columncolor{gray!20}}r>{\\columncolor{gray!30}}r>{\\columncolor{gray!40}}r>{\\columncolor{gray!50}}r>{\\columncolor{gray!60}}r}")
  tex.sprint("\\multicolumn{6}{l}{Rechnungsdetails} \\\\")
  tex.sprint("{Beschreibung} & {Menge} & {Stückpreis} & {USt. \\%} & {Stückpreis} & {Zwischensumme} \\\\")
  for _, item in ipairs(model.invoice.items) do
    tex.sprint("{", item.description, "} & {", item.quantity, "} & {", item.netAmount, "} € & {", item.taxation, "\\%} & {", item.totalAmount, " €} & {", item.sum, " €} \\\\")
  end
  tex.sprint(" & \\multicolumn{4}{l}{Gesamtpreis} & {", 18.77, " €} \\\\")
  tex.sprint("\\end{tabularx}")
\end{luacode}

% \begin{tabularx}{\textwidth}{Xrrrrr}
%   \multicolumn{6}{l}{Rechnungsdetails}
%   {Beschreibung} & {Menge} & {Stückpreis} & {USt. \%} & {Stückpreis} & {Zwischensumme}
%   {Pizza Margherita} & {1} & {4.50} € & {19 \%} & {5.36} € & {5.36} €
%   \cline{1-6}
%   & \multicolumn{4}{l}{Gesamtpreis} & {18.77 €}
% \end{tabularx}

% \begin{luacode}
%   tex.sprint("\\begin{tabularx}{\\textwidth}{>{\\columncolor{gray!10}}X>{\\columncolor{gray!20}}r>{\\columncolor{gray!30}}r>{\\columncolor{gray!40}}r>{\\columncolor{gray!50}}r>{\\columncolor{gray!60}}r}")
%   tex.sprint("\\multicolumn{6}{l}{Rechnungsdetails}\\tabularnewline")
%   tex.sprint("{Beschreibung} & {Menge} & {Stückpreis} & {USt. \\%} & {Stückpreis} & {Zwischensumme}")
%   for _, item in ipairs(model.invoice.items) do
%     tex.sprint(item.description, " & {", item.quantity, "} & {", item.netAmount, "} € & {", item.taxation, "\\%} & {", item.totalAmount, " €} & {", item.sum, " €} \\tabularnewline")
%   end
%   tex.sprint("\\cline{1-6}")
%   tex.sprint(" & \\multicolumn{4}{l}{Gesamtpreis} & {", 18.77, " €}")
%   tex.sprint("\\end{tabularx}")
% \end{luacode}

% \begin{luacode}
%   tex.print("\\begin{tabular*}{\\textwidth}{@{\\extracolsep{\\fill}}>{\\raggedright\\columncolor{gray!10}}p{0.3\\columnwidth}>{\\columncolor{gray!20}}r>{\\columncolor{gray!30}}r>{\\columncolor{gray!40}}r>{\\columncolor{gray!50}}r>{\\columncolor{gray!60}}r}")
%   tex.print("\\multicolumn{6}{l}{Rechnungsdetails}\\tabularnewline")
%   tex.print("{Beschreibung} & {Menge} & {Stückpreis} & {USt. \\%} & {Stückpreis} & {Summe}\\tabularnewline")
%   for _, item in ipairs(model.invoice.items) do
%     tex.sprint("{", item.description, "}", " & ")
%     tex.sprint("{", item.quantity, "}", " & ")
%     tex.sprint("{", item.netAmount, " €}", " & ")
%     tex.sprint("{", item.taxation, " \\%}", " & ")
%     tex.sprint("{", item.totalAmount, " €}", " & ")
%     tex.print("{", item.sum, " €}", "\\tabularnewline")
%   end
%   tex.print("\\cline{1-6}")
%   tex.print(" & \\multicolumn{4}{l}{Gesamtpreis} & {", 18.77, " €}\\\\")
%   tex.print("\\end{tabular*}")
% \end{luacode}

\end{document}
